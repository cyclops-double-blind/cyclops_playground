<?xml version="1.0"?>
<launch>
  <arg name="dataset_dir" value="$(dirname)/../dataset/$(arg dataset)"/>
  <arg name="dataset_path" value="$(arg dataset_dir)/$(arg sequence).bag"/>

  <group if="$(eval dataset == 'EuroC')">
    <arg if="$(eval sequence == 'MH_01')" name="start" value="45"/>
    <arg if="$(eval sequence == 'MH_02')" name="start" value="38"/>
    <arg if="$(eval sequence == 'MH_03')" name="start" value="20"/>
    <arg if="$(eval sequence == 'MH_04')" name="start" value="21"/>
    <arg if="$(eval sequence == 'MH_05')" name="start" value="20"/>

    <arg if="$(eval sequence == 'V1_01')" name="start" value="4.5"/>
    <arg if="$(eval sequence == 'V1_02')" name="start" value="4.5"/>
    <arg if="$(eval sequence == 'V1_03')" name="start" value="4.5"/>

    <arg if="$(eval sequence == 'V2_01')" name="start" value="4.5"/>
    <arg if="$(eval sequence == 'V2_02')" name="start" value="4.5"/>
    <arg if="$(eval sequence == 'V2_03')" name="start" value="4.5"/>

    <arg name="arguments"
      value="--clock -r $(arg play_rate) --start $(arg start) --pause"/>
    <node pkg="rosbag" type="play" name="player" output="screen"
      args="$(arg arguments) $(arg dataset_path)"/>
  </group>

  <group if="$(eval dataset == 'TUM')">
    <arg if="$(eval sequence == 'CR_01')" name="start" value="0"/>
    <arg if="$(eval sequence == 'CR_02')" name="start" value="0"/>
    <arg if="$(eval sequence == 'CR_03')" name="start" value="0"/>
    <arg if="$(eval sequence == 'CR_04')" name="start" value="0"/>
    <arg if="$(eval sequence == 'CR_05')" name="start" value="0"/>

    <arg name="arguments"
      value="--clock -r $(arg play_rate) --start $(arg start) --pause"/>
    <node pkg="rosbag" type="play" name="player" output="screen"
      args="$(arg arguments) $(arg dataset_path)"/>
  </group>

  <arg name="sequence_fullname" value="$(arg dataset)_$(arg sequence)"/>

  <arg if="$(eval not imu_only)"
    name="record_basename" value="cyclops_$(arg sequence_fullname)"/>
  <arg if="$(eval imu_only)"
    name="record_basename" value="cyclops_imu_only_$(arg sequence_fullname)"/>

  <node if="$(eval mode == 'cyclops')"
    pkg="rosbag" type="record" name="recorder" output="log"
    args="-o $(dirname)/../logs/$(arg record_basename)
      /cyclops_backend/init/accept
      /cyclops_backend/init/ambiguity
      /cyclops_backend/init/attempt
      /cyclops_backend/init/candidate_reject
      /cyclops_backend/init/failure
      /cyclops_backend/init/solution_reject
      /cyclops_backend/init/success
      /cyclops_backend/init/success/detail
      /cyclops_backend/init/vision/failure
      /cyclops_backend/init/vision/sanity
      /cyclops_backend/init/vision/success
      /cyclops_backend/keyframe
      /cyclops_backend/sanity/badness
      /cyclops_backend/sanity/failure
      /cyclops_backend/sanity/statistics
      /cyclops_backend/start">
  </node>
</launch>
